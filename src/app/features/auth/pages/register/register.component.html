<div class="auth-container">
  <app-background-particles></app-background-particles>
  <div class="auth-header">
    <app-gov-branding></app-gov-branding>
  </div>

  <div class="auth-content">
    <app-system-features></app-system-features>
    <mat-card>
      <mat-card-header>
        <mat-card-title>Create Your Profile</mat-card-title>
        <mat-card-subtitle>
          Welcome to the official digital profile registration system
        </mat-card-subtitle>
        <app-step-indicator
          [steps]="steps$ | async"
          [currentStepIndex]="(currentStep$ | async)! - 1"
          (stepChange)="onNextStep($event + 1)"
        ></app-step-indicator>
      </mat-card-header>

      <mat-card-content>
        <ng-container [ngSwitch]="currentStep$ | async">
          <app-register-step-one *ngSwitchCase="1"></app-register-step-one>
          <app-register-step-two *ngSwitchCase="2"></app-register-step-two>
          <app-register-step-three *ngSwitchCase="3"></app-register-step-three>
          <app-register-step-one *ngSwitchDefault></app-register-step-one>
        </ng-container>

        <div class="form-actions">
          <button
            mat-stroked-button
            color="primary"
            *ngIf="(currentStep$ | async)! > 1"
            (click)="handlePreviousStep()"
            [disabled]="loading"
          >
            Previous
          </button>

          <button
            mat-raised-button
            color="primary"
            *ngIf="!(isLastStep$ | async)"
            (click)="handleNextStep()"
            [disabled]="!(canProceedToNextStep$ | async) || loading"
          >
            Next
          </button>

          <button
            mat-raised-button
            color="primary"
            *ngIf="isLastStep$ | async"
            (click)="onSubmit()"
            [disabled]="!(canProceedToNextStep$ | async) || loading"
          >
            {{ loading ? "Creating Account..." : "Create Account" }}
          </button>
        </div>

        <div class="form-footer">
          <span>Already have an account?</span>
          <a mat-button routerLink="/auth/login">Sign in</a>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
