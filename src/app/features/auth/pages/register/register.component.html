<div class="auth-container">
  <div class="auth-content">
    <div class="branding">
      <img
        src="assets/images/nepal-government-logo.png"
        alt="Government Logo"
        class="gov-logo"
      />
      <h1 class="gov-title">नेपाल सरकार</h1>
      <h2 class="system-name-np">डिजिटल प्रोफाइल व्यवस्थापन प्रणाली</h2>
      <h3 class="system-name-en">Digital Profile Management System</h3>
    </div>

    <mat-card class="auth-card register-card" [class.loading]="loading">
      <mat-card-content>
        <form
          [formGroup]="registerForm"
          (ngSubmit)="onSubmit()"
          class="register-form"
        >
          <div class="form-header">
            <h2>Register New Account</h2>
            <p>
              Please fill in the registration form with accurate information
            </p>
          </div>

          <!-- Email Field -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Email</mat-label>
            <input
              matInput
              formControlName="email"
              type="email"
              placeholder="Enter your official email"
            />
            <mat-icon matPrefix>email</mat-icon>
            <mat-error *ngIf="registerForm.get('email')?.hasError('required')">
              Email is required
            </mat-error>
            <mat-error *ngIf="registerForm.get('email')?.hasError('email')">
              Please enter a valid email address
            </mat-error>
          </mat-form-field>

          <!-- Password Field -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Password</mat-label>
            <input
              matInput
              formControlName="password"
              [type]="hidePassword ? 'password' : 'text'"
              placeholder="Create a strong password"
            />
            <mat-icon matPrefix>lock</mat-icon>
            <button
              mat-icon-button
              matSuffix
              type="button"
              (click)="hidePassword = !hidePassword"
              [attr.aria-label]="'Hide password'"
              [attr.aria-pressed]="hidePassword"
            >
              <mat-icon>{{
                hidePassword ? "visibility_off" : "visibility"
              }}</mat-icon>
            </button>
            <mat-hint
              >Password must contain uppercase, lowercase, number and special
              character</mat-hint
            >
            <mat-error
              *ngIf="registerForm.get('password')?.hasError('required')"
            >
              Password is required
            </mat-error>
            <mat-error
              *ngIf="registerForm.get('password')?.hasError('pattern')"
            >
              Password must contain uppercase, lowercase, number and special
              character
            </mat-error>
          </mat-form-field>

          <!-- Full Name Fields -->
          <div class="name-fields">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Full Name (English)</mat-label>
              <input
                matInput
                formControlName="fullName"
                placeholder="Enter your full name in English"
              />
              <mat-icon matPrefix>person</mat-icon>
              <mat-error
                *ngIf="registerForm.get('fullName')?.hasError('required')"
              >
                Full name is required
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>पूरा नाम (नेपाली)</mat-label>
              <input
                matInput
                formControlName="fullNameNepali"
                placeholder="नेपालीमा पूरा नाम लेख्नुहोस्"
                class="nepali-input"
              />
              <mat-icon matPrefix>person</mat-icon>
              <mat-error
                *ngIf="registerForm.get('fullNameNepali')?.hasError('required')"
              >
                नेपाली नाम आवश्यक छ
              </mat-error>
              <mat-error
                *ngIf="
                  registerForm.get('fullNameNepali')?.hasError('nepaliName')
                "
              >
                कृपया मान्य नेपाली नाम प्रविष्ट गर्नुहोस्
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Date of Birth -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Date of Birth</mat-label>
            <input
              matInput
              [matDatepicker]="picker"
              formControlName="dateOfBirth"
              [max]="maxDate"
              placeholder="MM/DD/YYYY"
            />
            <mat-datepicker-toggle
              matPrefix
              [for]="picker"
            ></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
            <mat-error
              *ngIf="registerForm.get('dateOfBirth')?.hasError('required')"
            >
              Date of birth is required
            </mat-error>
          </mat-form-field>

          <!-- Address -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Address</mat-label>
            <textarea
              matInput
              formControlName="address"
              rows="2"
              placeholder="Enter your current address"
            ></textarea>
            <mat-icon matPrefix>location_on</mat-icon>
            <mat-error
              *ngIf="registerForm.get('address')?.hasError('required')"
            >
              Address is required
            </mat-error>
          </mat-form-field>

          <!-- Office Post -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Office Post</mat-label>
            <mat-select formControlName="officePost">
              <mat-option *ngFor="let post of officePosts" [value]="post">
                {{ post }}
              </mat-option>
            </mat-select>
            <mat-icon matPrefix>work</mat-icon>
            <mat-error
              *ngIf="registerForm.get('officePost')?.hasError('required')"
            >
              Office post is required
            </mat-error>
          </mat-form-field>

          <!-- Ward Number -->
          <mat-form-field
            appearance="outline"
            class="form-field"
            *ngIf="
              registerForm.get('officePost')?.value !==
              'Chief Administrative Officer'
            "
          >
            <mat-label>Ward Number</mat-label>
            <input
              matInput
              type="number"
              formControlName="wardNumber"
              min="1"
              max="50"
              placeholder="Enter ward number"
            />
            <mat-icon matPrefix>format_list_numbered</mat-icon>
            <mat-error
              *ngIf="registerForm.get('wardNumber')?.hasError('required')"
            >
              Ward number is required
            </mat-error>
            <mat-error *ngIf="registerForm.get('wardNumber')?.hasError('min')">
              Ward number must be at least 1
            </mat-error>
            <mat-error *ngIf="registerForm.get('wardNumber')?.hasError('max')">
              Ward number cannot exceed 50
            </mat-error>
          </mat-form-field>

          <!-- Server Error -->
          <div class="form-error" *ngIf="registerForm.hasError('serverError')">
            <mat-icon>error_outline</mat-icon>
            <span>{{ registerForm.getError("serverError") }}</span>
          </div>

          <!-- Form Actions -->
          <div class="form-actions">
            <button
              mat-raised-button
              color="primary"
              type="submit"
              [disabled]="registerForm.invalid || loading"
              class="submit-button"
            >
              <span>Register</span>
              <mat-spinner diameter="20" *ngIf="loading"></mat-spinner>
            </button>
            <a mat-button routerLink="/auth/login" class="login-link">
              Already have an account? Login
            </a>
          </div>
        </form>
      </mat-card-content>
    </mat-card>
  </div>
</div>
