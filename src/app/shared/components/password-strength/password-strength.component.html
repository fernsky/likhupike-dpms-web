<div
  class="password-strength-container"
  [ngClass]="size"
  role="region"
  aria-label="Password strength indicator"
>
  <!-- Live Region for Screen Readers -->
  <div class="sr-only" role="status" aria-live="polite">
    {{ getAriaAnnouncement() }}
  </div>

  <!-- Strength Meter -->
  <div
    class="strength-meter"
    role="progressbar"
    [attr.aria-valuenow]="strength"
    [attr.aria-valuetext]="getAriaValueText()"
    aria-valuemin="0"
    aria-valuemax="100"
  >
    <div class="segments-container">
      <div
        *ngFor="let segment of segments; let i = index"
        class="strength-segment"
        [ngClass]="{ active: segment.active }"
        [attr.data-segment]="i + 1"
        [style.backgroundColor]="segment.color"
        [@strengthAnimation]
        role="presentation"
      ></div>
    </div>

    <!-- Strength Label -->
    <div
      class="strength-label"
      *ngIf="showLabel"
      [@fadeInOut]
      role="status"
      [attr.aria-label]="'Current password strength: ' + strengthText"
    >
      <span
        class="label-text"
        [style.color]="strengthColor"
        [attr.data-strength]="strengthText.toLowerCase()"
      >
        {{ strengthText }}
      </span>
      <mat-icon
        [style.color]="strengthColor"
        class="strength-icon"
        [attr.aria-label]="getIconAriaLabel()"
      >
        {{ getStrengthIcon() }}
      </mat-icon>
    </div>
  </div>

  <!-- Requirements List -->
  <div
    class="requirements-list"
    *ngIf="showDetails"
    [@fadeInOut]
    role="list"
    aria-label="Password requirements checklist"
  >
    <div class="requirements-header" role="heading" aria-level="2">
      {{ "validation.password.requirements.title" | translate }}
    </div>

    <div class="requirements-grid" role="list">
      <div class="requirement" [ngClass]="{ met: requirements.length }">
        <mat-icon>
          {{ requirements.length ? "check_circle" : "radio_button_unchecked" }}
        </mat-icon>
        <span>At least 8 characters</span>
      </div>

      <div class="requirement" [ngClass]="{ met: requirements.lowercase }">
        <mat-icon>
          {{
            requirements.lowercase ? "check_circle" : "radio_button_unchecked"
          }}
        </mat-icon>
        <span>One lowercase letter</span>
      </div>

      <div class="requirement" [ngClass]="{ met: requirements.uppercase }">
        <mat-icon>
          {{
            requirements.uppercase ? "check_circle" : "radio_button_unchecked"
          }}
        </mat-icon>
        <span>One uppercase letter</span>
      </div>

      <div class="requirement" [ngClass]="{ met: requirements.numbers }">
        <mat-icon>
          {{ requirements.numbers ? "check_circle" : "radio_button_unchecked" }}
        </mat-icon>
        <span>One number</span>
      </div>

      <div class="requirement" [ngClass]="{ met: requirements.special }">
        <mat-icon>
          {{ requirements.special ? "check_circle" : "radio_button_unchecked" }}
        </mat-icon>
        <span>One special character</span>
      </div>
    </div>
  </div>

  <div *ngIf="keyboardMode" class="keyboard-help sr-only" aria-live="polite">
    Use arrow keys to navigate requirements. Press Space or Enter to focus on
    details.
  </div>
</div>
